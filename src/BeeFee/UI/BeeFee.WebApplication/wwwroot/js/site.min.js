function initIndexPage(n,t,i){var u,f,r,e;typeof n!="undefined"&&n!=null&&n.length!==0&&(u=2,f=9,i=typeof i!="boolean"?!1:i,r=!1,e=function(n){if(!i&&!r){r=!0;var e=[];$.each($(n.categoriesselector+":checked"),function(n,t){e.push($(t).val())});Events.loadEvents($(n.searchtextselector).val(),$(n.startdateselector).val(),$(n.enddateselector).val(),$(n.cityselector).val(),e,u,f,$(n.maxpriceselector).val()).done(function(n){i=n.allLoaded;n.html.length>0?$(t).append(n.html):$(t).append("Событий не найдено");u++}).fail(function(){}).always(function(){r=!1})}},$(window).scroll(function(){$(window).scrollTop()+$(window).height()==$(document).height()&&e(n[0])}))}function initEventPage(n,t,i){$(t).mask("+7 (999) 999-9999",{placeholder:"+7 (___) ___-____"});$(n).trigger("change");$(i).trigger("change")}function initCreateOrUpdateEventPage(){function t(n,t){var i="",r="";i+=t.getDate()+"/";i+=t.getMonth()+1+"/";i+=t.getFullYear();r+=t.getHours()<=9?"0"+t.getHours():t.getHours()+":";r+=t.getMinutes()<=9?"0"+t.getMinutes():t.getMinutes();n.find("span.is-s1").html(i);n.find("span.is-s2").html(r)}var n,i,r;$('[data-step-nav="next"]').on("click",function(n){n.preventDefault();var t=$(".create--step.is-shown"),i=t.find("form").data("validator");i.settings.ignore="";t.find("form").submit()});$(".html-editor").length>0&&(CKEDITOR.replace($(".html-editor")[0]),$(".html-editor").fadeIn("slow"));n=$("#File");n.fileupload({url:n.data("imageserverurl")+"/api/home",dataType:"json",type:"POST",formData:{setting:"event",companyName:n.data("companyurl"),eventName:n.data("eventurl")},done:function(t,i){var r=$("#File");if($("#errorUploadImage").remove(),i.result.error!=null){r.parent().before("<span id='#errorUploadImage' class=error>"+i.result.error+"<\/span>");return}r.prev().prev().remove();r.parent().prepend("<img src='"+n.data("imageserverurl")+"/min/"+n.data("companyurl")+"/"+n.data("eventurl")+"/368x190/"+i.result.path+"' />");$("#Cover").val(i.result.path)}}).prop("disabled",!$.support.fileInput).parent().find(".create--file-b").addClass($.support.fileInput?undefined:"disabled");$('[data-range="start"]').datetimepicker({onChangeDateTime:function(n,i){t(i.closest(".create--field-di"),n)}});$('[data-range="end"]').datetimepicker({onChangeDateTime:function(n,i){t(i.closest(".create--field-di"),n)}});$('[data-range="start"]').length>0&&$('[data-range="start"]').val().length>0&&t($('[data-range="start"]').closest(".create--field-di"),$('[data-range="start"]').data("xdsoft_datetimepicker").getValue());$('[data-range="end"]').length>0&&$('[data-range="end"]').val().length>0&&t($('[data-range="end"]').closest(".create--field-di"),$('[data-range="end"]').data("xdsoft_datetimepicker").getValue());i=$(".create--map-in");r=function(n){typeof ymaps!="undefined"&&ymaps.ready(function(){n.each(function(){var n=new ymaps.Map(this,{center:[55.751244,37.618423],zoom:10})})})};i.length>0&&$.getScript("https://api-maps.yandex.ru/2.1/?lang=ru_RU",function(){r(i)})}function getDoc(n){var t=null;try{n.contentWindow&&(t=n.contentWindow.document)}catch(i){}if(t)return t;try{t=n.contentDocument?n.contentDocument:n.document}catch(i){t=n.document}return t}function initFixedBox(){var n=$("div[data-fixed-wrap]>.container");n.length!=0&&(topFixed=n.offset().top+n.outerHeight(),prevTop=$(this).scrollTop(),prevShowTop=prevTop,$(window).scroll(function(){var n=$(this).scrollTop();if(n>prevTop||n<topFixed){$(".fixed-box").removeClass("is-shown");prevTop=n;return}n<prevTop&&(n>=topFixed&&n+2<prevTop&&($(".fixed-box").hasClass("is-shown")||$(".fixed-box").addClass("is-shown").slideDown(200)),prevTop=n);$(".fixed-box").hasClass("is-shown")||(prevTop=n)}))}var topFixed,prevTop=0,prevShowTop=0,Events;$(document).ready(function(){$('a[href="#"]').on({click:function(n){n.preventDefault()}});initLoginDialog();initFixedBox();$('[data-goto="filter"]').on({click:function(n){n.preventDefault();$("html, body").scrollTop($(".filter").offset().top-$('[data-fixed="header"]').outerHeight());$('[data-toggle="filter"]').addClass("is-active");$(".filter--body").slideDown(200,function(){$(this).is(":visible")&&$(this).find('input[type="text"]').first().focus()})}});$(".js-modals-close").on({click:function(n){n.preventDefault();$(".modals, .modals--item").fadeOut(200)}});$(".js-modals-open").on({click:function(n){n.preventDefault();var t=$(this).attr("modal-id");$(".modals").fadeIn(200);$(".modals--item#"+t).fadeIn(200,function(){$(this).find('input[type="text"]').first().focus()})}});$('[data-toggle="filter"]').on({click:function(n){n.preventDefault();$('[data-toggle="filter"]').toggleClass("is-active");$(".filter--body").slideToggle(200,function(){$(this).is(":visible")&&$(this).find('input[type="text"]').first().focus()})}});$(document).on("focus",".input-field",function(){$(this).addClass("with-focus")});$(document).on("blur",".input-field",function(){$(".input-field--i",this).val()===""&&$(this).removeClass("with-focus")});$(document).on("keyup",".input-field",function(){var n=$(this);n.removeClass("with-error");$(".input-field--i",this).val()!=""?n.addClass("with-value"):n.removeClass("with-value")});$(document).on("change",".input-field",function(){var n=$(this);n.removeClass("with-error");$(".input-field--i",this).val()!=""?n.addClass("with-value"):n.removeClass("with-value")});$(".vertical-field").each(function(){var n=$(this),t=$(this).find(".vertical-field--i");t.on({focus:function(){n.addClass("with-focus")},blur:function(){n.removeClass("with-focus")},keyup:function(){n.removeClass("with-error");$(this).val()!=""?n.addClass("with-value"):n.removeClass("with-value")}})});$(".select_in").on("click",function(){var n=$(this),t=n.closest(".select"),i=t.find(".select_list");i.is(":visible")?(i.slideUp(200),t.removeClass("is-opened"),n.find(".select_arrow").removeClass("is-active")):($(".select .select_list:visible").length&&($(".select .select_list:visible").hide(),$(".select .select_arrow").removeClass("is-active")),i.slideDown(200),t.addClass("is-opened"),n.find(".arrow").addClass("is-active"))});$(".select_list li").on("click",function(){var n=$(this),t=n.closest(".select").find(".select_in .select_title"),i=n.html();t.html(i);n.closest(".select").find("input[type=hidden]").val(n.attr("data-value"));n.closest(".select_list").find("li").removeClass("is-active");n.addClass("is-active");n.closest(".select_list").slideUp(200);n.closest(".select").removeClass("is-opened");n.closest(".select").find(".select_arrow").removeClass("is-active")});$(document).on("click",function(n){$(".select .select_list:visible").length&&!$(n.target).closest(".select").length&&($(".select").removeClass("is-opened"),$(".select .select_list").slideUp(200),$(".select .select_arrow").removeClass("is-active"))});$(document).keyup(function(n){n.keyCode==27&&($(".select").removeClass("is-opened"),$(".select .select_list").slideUp(200))});$(".create--file-i").on("change",function(){$(this).parent().find(".create--file-b").html($(this).val().split("\\").pop())});$.datetimepicker.setLocale("ru");$(".js-date").datetimepicker({timepicker:!1,format:"d.m.Y"});$('[data-checkboxes="total"]').on("change",function(){$(this).closest(".input-field--c, .vertical-field--c").find("input").prop("checked",$(this).prop("checked"))});$(".input-field--c input, .vertical-field--c input").on("change",function(){var n=!0,t=$(this).closest(".input-field--c, .vertical-field--c"),i=t.find('[data-checkboxes="total"]');t.find("input").not(i).each(function(){if($(this).prop("checked")==!1){n=!1;return}});i.prop("checked",n)})});Events={loadEvents:function(n,t,i,r,u,f,e,o){var h=$.Deferred(),s=[];return s.push("Text="+n),s.push("StartDate="+t),s.push("EndDate="+i),s.push("City="+r),s.push("PageIndex="+f),s.push("PageSize="+e),s.push("MaxPrice="+o),$.each(u,function(n,t){s.push("Categories="+t)}),$.ajax({url:"/event/loadevents?"+s.join("&"),cache:!1,success:function(n){h.resolve({allLoaded:n.allLoaded,html:n.html})},error:function(n,t){h.reject(n,t)}}),h.promise()}};